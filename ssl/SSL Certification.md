## SSL 인증서 (SSL Certification)



### 인증서 역할

- 내가(클라이언트) 접속한 서버가 접속하려는 서버가 맞는지 보장해 주는 것

-  위 내용 확인 후 공개키를 서버(웹서버)사용자에게 제공하는 것 

  인증서 내용 중 공개키는 포함되어있음



### CA (Certificate Authority)

- 인증서의 핵심 : 이 사이트가 신뢰할 수 있는지 클라이언트한테 알려주는 것 (클라이언트와 서버가 서로 신뢰할 수 없는 관계니까)
  
- 클라이언트가 접속한 서버가 의도한 서버가 맞는지 보장해주는 역할

- 이런 역할을 하는 민간 기업들을 CA, Root Certificate 라고 부름

  -> 애플(사파리 만듬), 마이크로스프트, 모질라(파이어폭스 만듬), 구글(크롬 만듬) 등이 해당되는 민간기업

- 민간기업들이 각자의 브라우저 마다 CA를 선정해서 선정된 목록을 자사의 브라우저 리스트에 탑재


### 인증서를 꼭 구매해서 사용해야 하는거야?

- 내가 직접 사용하는 서버 (ex. 개발서버, 사내에서만 사용하는 서버)는 굳이 인증서를 구매할 필요 없음 <br/>
  -> 왜냐면 이 도메인이 해당 사이트가 맞다는 것을 이미 인지하고있기 때문 (사이트에 대한 신뢰성은 이미 확보)

- 사이트에 대한 신뢰? 이미 확보 / 하지만 SSL의 암호화기능은 사용하고싶어?<br/>
  -> 사설인증서로 발급하면됨

- 사설인증서를 사용한다면? 내가 CA가 되는 것

- 사설인증서가 공인된건 아니기 때문에 public한 서비스는 사용하면안돼



### 인증서 내용

- 서비스 정보 (CA가 누구인지, 누가 발급한 것인지, 도메인 정보)
- 서버측 공개키 (공개키 내용, 공개키의 암호화 방식)



### 인증서가 클라이언트에게 전달되는 방식

- 웹브라우저가 SSL프로토콜을 이용해서 접속하게 되면

- 내부적으로 서비스는 서비스의 인증서를 클라이언트에게 전송

- 예시

  구글 로그인버튼 누르면 url이 https:~ 로 변경됨

  -> 클라이언트가 구글서버에 접속할때 SSL로 접속했다는 것

  ​    내부적으로 구글은 클라이언트에게 SSL인증서를 전송해줌 



### 알아야 되는 것

- 자신의 서버(웹서비스)에 접속하는 사용자들에게 인증서를 제공하는 것을 통해서 SSL인증서를 사용할 수있게 되는 것

- 인증기관에 대한 정보(CA)를 부라우저는 알고 있음




----



### 인증서 기능

1. 클라이언트가 접속한 서버가 신뢰 할 수 있는 서버임을 보장한다.
2. SSL 통신에 사용할 공개키를 클라이언트에게 제공



### CA

- 인증서의 역할은 클라이언트가 접속한 서버가 클라이언트가 의도한 서버가 맞는지를 보장하는 역할

- 이 역할을 하는 민간기업들이 있는데 이런 기업들을 CA(Certificate authority) 혹은 Root Certificate 라고 함

- CA는 아무 기업이나 할 수 있는 것이 아니고 신뢰성이 엄격하게 공인된 기업들만이 참여

  ex) Symantec, Comodo (Sectigo), GoDaddy, GlobalSign

- SSL을 통해서 암호화된 통신을 제공하려는 서비스는 CA를 통해서 인증서를 구입



### 사설 인증기관

- 개발이나 사적인 목적을 위해서 SSL의 암호화 기능을 이용하려한다면 자신이 직접 CA의 역할을 할 수 있음

-  공인된 인증서가 아니기 때문에 이러한 사설 CA의 인증서를 이용하는 경우 브라우저는 아래와 같은 경고 출력 <br/>
  -> https 빨간색되는거 



### SSL 인증서의 내용

1. 서비스의 정보 (인증서를 발급한 CA, 서비스의 도메인 등등)
2. 서버 측 공개키 (공개키의 내용, 공개키의 암호화 방법)

- 1번은 클라이언트가 접속한 서버가 클라이언트가 의도한 서버가 맞는지에 대한 내용

- 2번은 서버와 통신을 할 때 사용할 공개키와 그 공개키의 암호화 방법들의 정보

- 서비스의 도메인, 공개키와 같은 정보는 서비스가 CA로부터 인증서를 구입할 때 제출

- 위와 같은 내용은 CA에 의해서 암호화 되는데 이 기법이 공개키방식임

- CA는 자신의 CA 비공개키를 이용해서 서버가 제출한 인증서를 암호화하는 것

- CA의 비공개키는 절대로 유출되어서는 안됨

  -> '디지노타'라는 기업이 유출되서 파산되었음



### CA를 브라우저는 알고 있다

- 인증서를 이해하는데 꼭 알고 있어야 하는 것이 CA의 리스트

- 브라우저는 CA(=Root인증기관) 리스트를 갖고있음

  -> 이 말은 브라우저의 소스코드 안에 CA의 리스트가 들어있다는 것

- 브라우저가 미리 파악하고 있는 CA의 리스트에 포함되어야만 공인된 CA가 될 수 있음
- CA의 리스트와 함께 각 [CA의 공개키](https://opentutorials.org/course/228/4894#public)를 브라우저는 이미 알고있음



### SSL인증서가 서비스를 보증하는 방법 (아주 간단한 인증서 동작방법)

1. 웹브라우저가 서버에 접속할때, 서버는 웹브라우저에 인증서를 줌

2. 웹브라우저는 받은 인증서가 자기가 갖고있는 CA리스트에 있는지 확인

3. 서버에서 준 인증서가 브라우저가 갖고있던 CA인증기관 리스트에 포함되어있는지 확인

4. 브라우저는 이미 자기가 갖고있는 CA에 대한 공개키는 갖고있으니! (얼쑤)

5. 갖고있는 공개키를 인증서를 복호화함 <br/>
   -> 왜냐면 인증서라고 하는건, 인증기관의 비밀키로 암호화 된 것이고 ! (얼쑤2) <br/>
             암호화 된 것은, 공개키로 풀 수있으니꽈 (== 공개키로 복호화한 그정보가, 틀림없이 그 공개키와 쌍으로 존재하는 비공개키를 가진 사람이 풀었구나 !)

6. 복호화 성공함 ?
   -> 그 인증서가 공인된 기관에 의해서 인증된 정보라는걸 알 수 있음 <br/>
      공인된 기관 say : 그 인증서는 믿어도되유 ~
