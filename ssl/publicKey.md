## 공개키



### 공개키와 대칭키의 차이점

- 공개키는 키가 2개 (쌍으로 존재) / 공개키 방식임



### 공개키 암호화 방식

- 키가 쌍으로 존재

  A키로 암호화했다면, 반드니 B키로 복호화 해야함

  B키로 암호화했다면, 반드니 A키로 복호화 해야함

- 복호화는 반드시 비밀키(private key)로만 암호화 가능

  공개키를 갖고 있어도 비밀키가 없으면 아무도 복호화 불가능

- 장점
  - 키를 배달하는 사고가 발생되지 않음 (?)

#### 인증 방식

- 인증
  - 자신이 받은 정보가 올바른 사람이 전송한건지 확인하는것 

#### 인증서의 원리

- 내가 전송한 정보를 받은 사람이 갖고있는 공개키로 복호화가 성공했다면

  -> 비밀키를 갖고있는 사람이 전송한 정보라는게 보증됨



----



### 대칭키 방식

- 단점

  - 암호를 주고 받는 사람들끼리 대칭키를 전달하는데 어려움

    대칭키가 유출되면 키를 확득한 사람이 복호화 가능하기 때문

    -> 그래서 나온 방식이 **공개키방식**



### 공개키 방식

- 두개의 키를 갖게 되는데 A키로 암호화를 하면 B키로 복호화 할 수 있고, B키로 암호화하면 A키로 복호화 할 수 있는 방식

  이 방식에 착안해서 두개의 키 중 하나를 비공개키(private key, 개인키, 비밀키라고도 부른다)로하고, 나머지를 공개키(public key)로 지정

- 비공개키는 자신만이 가지고 있음 / 공개키는 타인에게 제공
- 공개키를 제공 받은 타인은 공개키를 이용해서 정보를 암호화
- 암호화한 정보를 비공개키를 가지고 있는 사람에게 전송
- 비공개키의 소유자는 이 키를 이용해서 암호화된 정보를 복호화
- 장점
  - 이 과정에서 공개키가 유출된다고해도 비공개키를 모르면 정보를 복호화 할 수 없기 때문에 안전
    - 공개키로는 암호화는 할 수 있지만 복호화는 할 수 없기 때문



### 공개키 방식 응용

- 비공개키의 소유자는 비공개키를 이용해서 정보를 암호화 한 후에 공개키와 함께 암호화된 정보를 전송

- 정보와 공개키를 획득한 사람은 공개키를 이용해서 암호화된 정보를 복호화

  - 이 과정에서 공개키가 유출된다면 의도하지 않은 공격자에 의해서 데이터가 복호화 될 위험 -> 이럼에도 불구하고 비공개키를 이용해서 암호화 하는 이유?

    - 데이터를 보호하는 것이 목적이 아니기 때문

    - 암호화된 데이터를 공개키를 가지고 복호화 할 수 있다는 것은 그 데이터가 공개키와 쌍을 이루는 비공개키에 의해서 암호화 되었다는 것을 의미

      **즉 공개키가 데이터를 제공한 사람의 신원을 보장** -> 전자 서명 이라함





그럼 이해를 돕기 위해서 공개키를 이용해서 RSA라는 방식의 공개키를 사용해보자. 아래 명령은 private.pem이라는 이름의 키를 생성한다. 이 키는 1024bit 길이을 갖는다. 이 숫자가 높을수록 안전하다.

> openssl genrsa -out private.pem 1024;

다음 명령은 private.pem이라는 이름의 비공개키에 대한 public.pem이라는 이름의 공개키를 생성한다. 이 공개키를 자신에게 정보를 제공할 사람에게 전송하면 된다.

> openssl rsa -``in` `private.pem -out public.pem -outform PEM -pubout;

공개키를 가진 사람이 어떤 정보를 비공개키를 가지고 있는 사람에게 전송하는 상황을 상정해보자. 아래는 coding everybody라는 이름의 문자를 담고 있는 file.txt를 만든다. 이 데이터를 비공개키 소유자에게 전송하기 위해서는 암호화가 필요하다.

> echo` `'coding everybody'` `> ``file``.txt

file.txt를 암호화 해보자. 아래의 예제는 file.txt의 내용을 RSA방식으로 암호화한 file.ssl이라는 이름의 파일을 생성한다. 이 때 사용된 공개키가 public.pem이다. 이제 안심하고 file.txt를 암호화한 결과인 file.ssl을 비공개키의 소유자에게 전송할 수 있다.

> openssl rsautl -encrypt -inkey public.pem -pubin -``in` `file``.txt -out ``file``.ssl;

그럼 file.ssl을 수신받은 비공개키 소유자가 어떻게 이 정보를 복호화 할 수 있는지 알아보자. 아래 예제는 file.ssl을 복호화한 결과를 decrypted.txt로 만들어내는 방법을 보여준다. 이 과정에서 비공개키인 private.pem을 사용했다.

> openssl rsautl -decrypt -inkey private.pem -``in` `file``.ssl -out decrypted.txt



